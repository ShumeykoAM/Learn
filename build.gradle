apply plugin: 'java'

//repositories {
//    mavenCentral() //Не работает из за какой то лицензии, надо разобраться
//}

//Зависимости, зависимости задаются для конфигураций, у гредла по умолчанию несколько конфигураций
dependencies{
    //Для конфигурации testCompile  мы указываем зависимость, для импорта org.junit
    testCompile fileTree(dir: 'src/test/library', include: '*.jar')

    // https://mvnrepository.com/artifact/javax.validation/validation-api
    //compile group: 'javax.validation', name: 'validation-api', version: '2.0.0.Alpha1'
    compile fileTree(dir:'src/main/library')

}

test.doFirst{
    copy {
        from ('src/test/resources/META-INF/beans.xml')
        into ('build/classes/test/META-INF')
    }
    copy {
        //Походу дела какой то косяк в Weld или во мне, но Weld всегда использует файл из main/META-INF
        from ('src/test/resources/META-INF/beans.xml')
        into ('build/classes/main/META-INF')
    }

}

//Скопируем файлы ресурсов что бы WeldContainer работал
build.doLast{
    //if (tasks.compileJava.didWork) {
        copy {
            from ('src/main/resources/META-INF/beans.xml')
            into ('build/classes/main/META-INF')
        }          
    //}
}
